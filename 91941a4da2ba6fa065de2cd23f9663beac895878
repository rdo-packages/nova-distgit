{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e0bc4a30_3a54c680",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 715
      },
      "writtenOn": "2022-02-15T19:06:40Z",
      "side": 1,
      "message": "recheck",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "76be4622_3de0646c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 761
      },
      "writtenOn": "2022-02-15T21:58:38Z",
      "side": 1,
      "message": "\u003e And regarding the security concern, I believe the the original way is more secure and let me explain:\n\u003e - A rogue ssh client can only execute what it\u0027s able to pass to the remote host.\n\u003e - By strictly checking the command, we make sure they can only execute these specific commands.\n\u003e - Unless they already have access to the host and can overwrite these commands, their impact is pretty limited\n\u003e - By using regex like this, I believe that it\u0027s possible to do something like this:\n\u003e         nc +$ARG +-U +/var/run/libvirt/libvirt-sock\"; su -c \"evil commands\"\n\nUnless I missed something, that will actually not work because we\nonly look at ``SSH_ORIGINAL_COMMAND`` (i.e. the command provided by the\nssh client) to decide whether virt-ssh-helper or nc should be used:\nafter that has been determined, the entire script is thrown out and\nwe explicitly call either `virt-ssh-helper qemu:///system` or `nc -U\n/var/run/libvirt/libvirt-sock`. So there is no possibility for a\nrogue client to inject malicious commands.\n\nI\u0027ve updated the commit message to clarify this further, and of\ncourse addressed the nits you pointed out as well.\n\nThanks a lot for your quick and thorough review! :)",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "83384760_7a8d3e61",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 761
      },
      "writtenOn": "2022-02-15T22:00:01Z",
      "side": 1,
      "message": "I just realized my comments had been sitting as drafts for hours ðŸ¤¦\n\nIs it very obvious that this is my first time using Gerrit?",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2dc71bff_9f874864",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 715
      },
      "writtenOn": "2022-02-16T18:46:19Z",
      "side": 1,
      "message": "Please, don\u0027t feel bad, it still happens to me ðŸ¤¦",
      "parentUuid": "83384760_7a8d3e61",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2cc9c339_6c9bd313",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 128
      },
      "writtenOn": "2022-02-22T08:21:00Z",
      "side": 1,
      "message": "Wouldn\u0027t be better to have this script in upstream repo?",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "72983cc9_ccf23a87",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 715
      },
      "writtenOn": "2022-02-22T14:10:32Z",
      "side": 1,
      "message": "We proposed it recently and it was refused in THT",
      "parentUuid": "2cc9c339_6c9bd313",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c8017d7b_8bb15b6d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 600
      },
      "writtenOn": "2022-02-22T14:15:41Z",
      "side": 1,
      "message": "yes we would like to remove it from this repo and move it to THT\nit is not something that should be in nova itself as this is a ooo specific script that in a normal nova deployment should not be required.",
      "parentUuid": "72983cc9_ccf23a87",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4329ddf3_2c353400",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 761
      },
      "writtenOn": "2022-02-22T15:07:41Z",
      "side": 1,
      "message": "Thanks a lot everyone! I\u0027m quite impressed by how smooth it was to get my first contribution accepted ðŸ˜Š\n\nA couple of follow-up questions.\n\nI see that the initial implementation of virt-ssh-helper detection (https://review.rdoproject.org/r/c/openstack/nova-distgit/+/36142) was backported to the wallaby and xena releases. Would it make sense to do the same for this change? It should be trivial and I don\u0027t mind doing it.\n\nMore relevant to my interests, what is the project\u0027s policy when it comes to picking up new libvirt versions? I see in the spec file that there is an explicit requirement for libvirt \u003e\u003d 5.0.0, but that doesn\u0027t tell me whether the next release is going to ship with a version newer than 8.0.0 or whether older releases will get rebased libvirt versions over their lifetimes.\n\nIt is important for me to understand that because it sets the timeline for getting my libvirt changes in. Specifically, if old releases are not going to ever get libvirt \u003e 8.0.0 then I don\u0027t need to worry about my changes possibly breaking them.\n\nThanks again!",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "090bd7c2_46c98257",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 761
      },
      "writtenOn": "2022-02-25T14:03:23Z",
      "side": 1,
      "message": "I noticed that I accidentally marked this as \"resolved\" and perhaps that\u0027s causing it to go unnoticed. Replying to unmark it, which is hopefully a reasonable thing to do in such cases. Apologies for the noise!",
      "parentUuid": "4329ddf3_2c353400",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21732128_c5ce4e28",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 761
      },
      "writtenOn": "2022-03-07T18:19:02Z",
      "side": 1,
      "message": "Polite ping ðŸ˜Š\n\nIt\u0027d be really useful for me to have answers to the questions above so I can try to push the libvirt changes forward.",
      "parentUuid": "090bd7c2_46c98257",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1fae6f7f_1f2c2e01",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 600
      },
      "writtenOn": "2022-03-07T18:35:49Z",
      "side": 1,
      "message": "the minium requirement should ideally not exceed the min libvirt/qemu listed in nova. its entirely fine for nova to be used with 8.0.0 \n\nthe current min version for yoga is documented here\nhttps://github.com/openstack/nova/blob/master/nova/virt/libvirt/driver.py#L219-L220\nMIN_LIBVIRT_VERSION \u003d (6, 0, 0)\nMIN_QEMU_VERSION \u003d (4, 2, 0)\n\nso the spec file and and should be update  on master and stable/yoga to libvirt\u003e\u003d6.0.0\n\nthese RPMS can be used in a number of contexts.\nthey will be used downstream as the bases of redhats OSP(openstack platfrom) product where the libvirt and qemu version will be determined by the RHEL product teams. they are directly used upstream by the rdo comunity on censtos stream 8 and centos stream 9.\n\nthe version of libvirt that will be used will depend on the exact os that the pacakge is installed on.\n\ncentos stream 9 support will be backported to stable/wallaby \n\nwith regards to your libvirt changes they woudl need to work with the libvirt supplied on centos 8 and centos 9. im not entirely sure if we need to backport this as i mainly maintain nova not the deployment aspect which this si modifying.\n\nevenutaly i want to see this script removed form this repo and move to tripleo instead as this should not be part fo the nova distgit repo but for now we have not got agreement form them to accpet it there.",
      "parentUuid": "21732128_c5ce4e28",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee7d054a_3d4e08f5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 761
      },
      "writtenOn": "2022-03-08T18:33:27Z",
      "side": 1,
      "message": "Thank you for your input Sean!\n\n\u003e the minium requirement should ideally not exceed the min libvirt/qemu listed in nova. its entirely fine for nova to be used with 8.0.0 \n\u003e \n\u003e the current min version for yoga is documented here\n\u003e https://github.com/openstack/nova/blob/master/nova/virt/libvirt/driver.py#L219-L220\n\u003e MIN_LIBVIRT_VERSION \u003d (6, 0, 0)\n\u003e MIN_QEMU_VERSION \u003d (4, 2, 0)\n\u003e \n\u003e so the spec file and and should be update  on master and stable/yoga to libvirt\u003e\u003d6.0.0\n\nTo be clear, the changes I\u0027ve made to the script do not in any way cause the minimum version of libvirt required by nova to increase.\n\n\u003e these RPMS can be used in a number of contexts.\n\u003e they will be used downstream as the bases of redhats OSP(openstack platfrom) product where the libvirt and qemu version will be determined by the RHEL product teams. they are directly used upstream by the rdo comunity on censtos stream 8 and centos stream 9.\n\u003e \n\u003e the version of libvirt that will be used will depend on the exact os that the pacakge is installed on.\n\u003e \n\u003e centos stream 9 support will be backported to stable/wallaby \n\u003e \n\u003e with regards to your libvirt changes they woudl need to work with the libvirt supplied on centos 8 and centos 9.\n\nI understand that the RPMs could be deployed on a number of different OS and have to work against old versions of libvirt. That\u0027s fine, and my changes to the script don\u0027t negatively affect that.\n\nFor the purpose of getting my pending libvirt changes approved, the question is sort of the opposite: do people deploy old versions of RDO on new versions of the OS?\n\nLet\u0027s assume my changes make it into libvirt 8.2.0. How likely is it that someone would deploy an old version of nova, let\u0027s say wallaby, on an OS that\u0027s recent enough to carry libvirt 8.2.0? And if I backport the changes made to the script to wallaby, thus making it compatible with libvirt 8.2.0, how likely is it that someone would deploy an old, unpatched version on an OS that\u0027s recent enough to have libvirt 8.2.0?\n\nAs a parallel, for libvirt itself the expectation is that you won\u0027t use it to drive a version of QEMU that\u0027s more recent than the library. Can it be similarly assumed that you won\u0027t deploy nova against a version of libvirt that is more recent than it is?\n\n\u003e im not entirely sure if we need to backport this as i mainly maintain nova not the deployment aspect which this si modifying.\n\nI think I\u0027m just going to do the backports, submit them and see what happens. It\u0027s just more sane to have fewer variations of the script floating around anyway.\n\n\u003e evenutaly i want to see this script removed form this repo and move to tripleo instead as this should not be part fo the nova distgit repo but for now we have not got agreement form them to accpet it there.\n\nBased on the little understanding I have this makes sense to me.\n\nLet me take this opportunity to stress just how much I appreciate the fact that this uncertainty was not a blocker to get my changes in. Other projects might have required that the script is moved before it can be changed, and as a drive-by contributor I was extremely relieved that this was not the case here ðŸ˜Š",
      "parentUuid": "1fae6f7f_1f2c2e01",
      "revId": "91941a4da2ba6fa065de2cd23f9663beac895878",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    }
  ]
}